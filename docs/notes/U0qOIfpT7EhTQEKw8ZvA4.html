<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Continuous Integration and Continuous Deployment - Sameep</title>
  

  <link
    rel="shortcut icon"
    href="https://sameep1234.github.io/notes/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://sameep1234.github.io/notes/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://sameep1234.github.io/notes/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://sameep1234.github.io/notes/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
   
  
<meta name="description" content="Personal knowledge space">
<meta name="author" content="Sameep">

<link rel="canonical" href="https://sameep1234.github.io/notes/U0qOIfpT7EhTQEKw8ZvA4.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://sameep1234.github.io/notes/U0qOIfpT7EhTQEKw8ZvA4.html">
<meta property="og:description" content="Personal knowledge space">
<meta property="og:image" content="https://sameep1234.github.io/logo.gif">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://sameep1234.github.io/notes/U0qOIfpT7EhTQEKw8ZvA4.html">
<meta name="twitter:description" content="Personal knowledge space">
<meta name="twitter:image" content="https://sameep1234.github.io/logo.gif">


  <meta property="og:title" content="Continuous Integration and Continuous Deployment - Sameep" />
  <meta name="twitter:title" content="Continuous Integration and Continuous Deployment - Sameep" />
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VZ67P3SVZE"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-VZ67P3SVZE');
  </script>
  
</head>



<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://sameep1234.github.io/notes" class="site-title lh-tight">
  <div class="site-logo"></div>

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Sameep" aria-label="Search Sameep" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://sameep1234.github.io/notes">Curated Notes</a></li><li class="breadcrumb-nav-list-item"><a href="https://sameep1234.github.io/notes/notes/3ONxZ3Khb7nFPdLxlV1ib.html">Stepwellradio</a></li><li class="breadcrumb-nav-list-item"><a href="https://sameep1234.github.io/notes/notes/xm1zwK8k3nHvutw0hqXhh.html">Steptech</a></li><li class="breadcrumb-nav-list-item">Continuous Integration and Continuous Deployment</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        
        

        

        

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Continuous Integration and Continuous Deployment">
    
    <meta itemprop="datePublished" content="2021-09-12T15:11:52+00:00">
    <meta itemprop="dateModified" content="2021-09-12T18:19:37+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="continuous-integration-and-continuous-deployment"><a aria-hidden="true" class="anchor-heading" href="#continuous-integration-and-continuous-deployment"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Continuous Integration and Continuous Deployment</h1>
<h2 id="using-github-actions"><a aria-hidden="true" class="anchor-heading" href="#using-github-actions"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Using Github actions</h2>
<h3 id="continuous-integrations-ci"><a aria-hidden="true" class="anchor-heading" href="#continuous-integrations-ci"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Continuous Integrations (CI)</h3>
<ul>
<li>DevOps software development practice to automate the integration of code changs from multiple contributors into a single software project.</li>
<li>In simple terms, CI helps to build your code as soon as it is pushed into the branch where CI workflow is defined.</li>
<li>This way we don't have to manually build and check for errors in the code. It would all be automated and done by github actions.</li>
<li>Steps
<ul>
<li>Go to github actions tab on the site.</li>
<li>Click create new workflow.</li>
<li>Under the continuous integration workflows, click more  continuous integration workflows.</li>
<li>Select the <strong>Python application</strong> and click set up this workflow.
<ul>
<li>name: Self-explanatory</li>
<li>on: when do you want to trigger the scripts</li>
<li>push: Implies that the scripts will trigger on push</li>
<li>branches: On which branch shall the "event" (push, pull etc) occur, so as to trigger CI workflow.</li>
<li>jobs: <strong>Most important part.</strong></li>
<li>build: We specify whether we are building or deploying (write deploy instead of build to let it know that its a deploy script)</li>
<li>runs-on: Remote desktop offered by <strong>github.</strong></li>
<li>steps: Self-explanatory</li>
<li>uses: preferable keep it actions/checkout<a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">@v2 (Private)</a>. It implies that we are just building and not deploying. For deploying we will need to "ssh" into the server and hence we will need to change this.</li>
<li>name: name of the script</li>
<li>uses: Since, we selected python, keep it as it is.</li>
<li>with: Specify the version, for us it would be a python version.</li>
<li>run: Here write the script for building your project
<pre class="language-bash"><code class="language-bash">pip <span class="token function">install</span> flake8
pip <span class="token function">install</span> pytest
<span class="token builtin class-name">cd</span> frontend
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run build
</code></pre>
</li>
<li>The above script builds our react frontend project.</li>
<li>flake8 is a python library to check coding styles and warnings including some imported libraries that are unused and undefined names etc.</li>
<li>For information on pytest follow this <a href="https://realpython.com/pytest-python-testing/">link</a></li>
<li>Initially pytest will give an error and hence it would be better to comment it. This bug is yet to be fixed.</li>
<li>Commit the file and your CI is ready to go!</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Check for errors in the details section and resolve any that is encountered.</p>
</blockquote>
<h3 id="continuous-deployment-cd"><a aria-hidden="true" class="anchor-heading" href="#continuous-deployment-cd"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Continuous Deployment (CD)</h3>
<ul>
<li>It is a software release process that uses automated testing to validate any changes and deploys it to the server.</li>
<li>Simply put, after CI, it deploys your code to the production environment automatically.</li>
</ul>
<blockquote>
<p>There are two ways to acheive this. One, to accomodate the code in the CI.yml file itself and the other is to create a whole new file for increasing modularity.</p>
<ul>
<li>We have done the second approach.</li>
<li>For the first one, copy the build code written above and instead of build (under jobs), write deploy and then write the code as per the below steps.</li>
</ul>
</blockquote>
<ul>
<li>Steps
<ul>
<li>Go to actions tab on the site.</li>
<li>Click create new workflow.</li>
<li>Click on <strong>create a workflow yourself.</strong></li>
<li>Most of the code remains the same as that in CI.</li>
<li>Under jobs, replace build with deploy.</li>
<li>Delete the <strong>workflow_dispatch</strong> code.</li>
<li>Further, delete the <strong>uses section and single command code</strong> under <strong>steps</strong>.</li>
<li>By now, you will only be left with one multi-line script under <strong>steps</strong>.</li>
<li>Replace the <strong>name</strong> with anything relavant.</li>
<li>Then type the following without any tabs or indentation. <strong>Note that the following should be exactly below name and without a hypen (-)</strong>
<ul>
<li>uses: appleboy/ssh-action<a title="Private" style="color: brown" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank">@master (Private)</a></li>
<li>This allows github to "ssh" into our server.</li>
</ul>
</li>
<li>Now open a terminal in your <strong>local machine</strong> and type the following command.
<ul>
<li>
<pre class="language-bash"><code class="language-bash">    ssh-keygen -C <span class="token operator">&#x3C;</span>EMAILID<span class="token operator">></span>
</code></pre>
</li>
<li>Make sure to replace <emailid> with radio's email ID.</emailid></li>
<li>This will create a new public and private key.</li>
</ul>
</li>
<li>Then, go to the settings of the repository.</li>
<li>Left hand side, click on secrets and then click on new repository secret.</li>
<li>Provide your newly created <strong>private key</strong> and name it anything relevant.</li>
<li>Now "ssh" into the server and under .ssh/authorized_keys, place the newly created <strong>public key</strong> in it.</li>
<li>Now go back on github site and add the with section shown in the below image. Make sure it is exactly the same except changing the secrets name accoring to what you have added in github secrets.</li>
<li><img src="/notes/assets/images/2021-09-12-18-19-36.png"></li>
<li><strong>Make sure that you change the secrets with your respective server.</strong></li>
<li>With the same indentation as that of host, key etc. write script for deployment.</li>
<li>script: |
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">cd</span> stepwellradio
<span class="token function">git</span> pull https://<span class="token operator">&#x3C;</span>YOUR_USERNAME<span class="token operator">></span>:<span class="token operator">&#x3C;</span>PERSONAL ACCESS TOKEN<span class="token operator">></span>@github.com/<span class="token operator">&#x3C;</span>USERNAME<span class="token operator">></span><span class="token operator">&#x3C;</span>REPO_NAME<span class="token operator">></span>.git
python -m pip <span class="token function">install</span> --upgrade pip
pip <span class="token function">install</span> flake8 pytest
<span class="token keyword">if</span> <span class="token punctuation">[</span> -f requirements.txt <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> pip <span class="token function">install</span> -r requirements.txt<span class="token punctuation">;</span> <span class="token keyword">fi</span>
<span class="token builtin class-name">cd</span> frontend
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token builtin class-name">cd</span> backend
python manage.py collectstatic
<span class="token builtin class-name">echo</span> <span class="token string">"Deployed Successfully"</span>
</code></pre>
</li>
<li>Once it is done, you are good to go.</li>
<li>Check details of guthub actions to make sure that there aren't any errors during the deployment.</li>
<li>Some potential errors
<ul>
<li>python, pip, nodejs and npm not installed.</li>
<li>So make sure that these are installed on the server.</li>
<li><strong>Note that these errors are just for first time set up of the server and hence the commands that are needed to install these need not be placed under the scripts.</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>There are certain errors that are yet to be resolved like deploy should happen after build returns exit code 0 and some python virtual environment related issues.</p>
</blockquote><span id="navId" data="U0qOIfpT7EhTQEKw8ZvA4"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>

        <div class="thumbs feedback_trigger right-bottom"></div>

        
          <hr>
          <footer>
            
            

            
              <div class="d-flex mt-2">
              <p class="text-small text-grey-dk-000 mb-0 mr-2">
                Page last modified: <span class="d-inline-block">12/9/2021</span>.
              </p>
            
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>

</body>
</html>
