{"pageProps":{"note":{"id":"C10dnDFKygqMWaWd4pUMm","title":"Lecture 3","vault":{"fsPath":"vault"},"type":"note","desc":"","links":[],"anchors":{"timer-cont":{"type":"header","text":"Timer (Cont.)","value":"timer-cont","line":9,"column":0},"extra-points":{"type":"header","text":"Extra Points","value":"extra-points","line":11,"column":0},"steps-for-programming":{"type":"header","text":"Steps for programming","value":"steps-for-programming","line":22,"column":0},"tifr-circuit":{"type":"header","text":"TIFR Circuit","value":"tifr-circuit","line":31,"column":0}},"fname":"courses.Semester 5.Embedded Systems.Lecture 3","updated":1630910764458,"created":1630905993189,"parent":"a1PatlsCiz7PYsL111lFm","children":[],"data":{},"contentHash":"caddd7e9b56f6986c03e6a2019fe956d","custom":{}},"body":"<h1 id=\"lecture-3\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#lecture-3\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Lecture 3</h1>\n<h2 id=\"timer-cont\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#timer-cont\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Timer (Cont.)</h2>\n<h2 id=\"extra-points\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#extra-points\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Extra Points</h2>\n<ul>\n<li>If prescaling is applied, we multiply the time period of the AVR microcontroller by the same amount as the prescaling ratio.</li>\n<li>Prescaler simply means that we are increasing the time period of the clock. Consequently, we are decreasing the frequency of the clock.</li>\n<li>Time Delay\n<ul>\n<li>Hex Value\n<ul>\n<li><img src=\"/notes/assets/images/2021-09-06-11-10-19.png\"></li>\n</ul>\n</li>\n<li>Decimal Value\n<ul>\n<li><img src=\"/notes/assets/images/2021-09-06-11-11-09.png\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>To clear any flag, write logic <strong>\"1\"</strong> to it.</li>\n</ul>\n<h2 id=\"steps-for-programming\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#steps-for-programming\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Steps for programming</h2>\n<ul>\n<li><img src=\"/notes/assets/images/2021-09-06-11-23-39.png\"></li>\n<li><img src=\"/notes/assets/images/2021-09-06-11-32-17.png\"></li>\n</ul>\n<blockquote>\n<p>Question that remains is how to store/measure overflow flag?</p>\n<ul>\n<li>For that we use TIFR (Timer/Counter Interrupt Flag Register). It has dedicated 1-bit to store every flag that we may encounter.</li>\n</ul>\n</blockquote>\n<h2 id=\"tifr-circuit\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#tifr-circuit\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>TIFR Circuit</h2>\n<ul>\n<li>\n<p>It is an 8-bit register.</p>\n</li>\n<li>\n<p>Stores flags and <strong>overflow flag is set on 0th bit</strong>.</p>\n</li>\n<li>\n<p>Value \"1\" implies overflowed and vice versa.</p>\n<blockquote>\n<p>The below given figure will be provided for reference in exam.</p>\n</blockquote>\n</li>\n<li>\n<p><img src=\"/notes/assets/images/2021-09-06-11-37-11.png\"></p>\n</li>\n<li>\n<p>Prescalers slows down the clock. Hence increases the time period.</p>\n</li>\n<li>\n<p>Thus, multiply the prescaler to clock time period to get the adequate delay.</p>\n</li>\n<li>\n<p>Overflow flag is located on 0th bit. Hence to check overflow we check TIFR &#x26; 0x1 to be 0.</p>\n</li>\n<li>\n<p><strong>Make sure that to reset the flag by putting \"1\" to the flag.</strong></p>\n</li>\n<li>\n<p>The reason for this could be understood using an analogy. These are not the direct registers. These like control registers which means they act as a switch. We are pressing the \"reset\" switch (by putting \"1\") and in turn it is telling the actual register to reset the values. Thus, instead of 0, we are passing 1.</p>\n</li>\n<li>\n<p>Example questions</p>\n<ul>\n<li><img src=\"/notes/assets/images/2021-09-06-11-40-28.png\"></li>\n<li><img src=\"/notes/assets/images/2021-09-06-11-42-27.png\"></li>\n<li>Toggle bits on 4th Pin of PORTB continuously with delay of 70 microseconds. Use Timer0, normal mode and 1:8 prescaler. Frequency of clock is 8MHz.</li>\n</ul>\n</li>\n</ul>\n<pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&#x3C;avr/io.h></span></span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">T0Delay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    TCNT0 <span class=\"token operator\">=</span> <span class=\"token number\">0xBA</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Calculated using the formula</span>\n    TCCR0 <span class=\"token operator\">=</span> <span class=\"token number\">0x02</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1:8 prescaler value using the table</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>TIFR <span class=\"token operator\">&#x26;</span> <span class=\"token number\">0x1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Continuously run until flag is activated</span>\n    TCCR0 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Stop the clock</span>\n    TIFR <span class=\"token operator\">=</span> <span class=\"token number\">0x1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Reset the values.</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tDDRB <span class=\"token operator\">=</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// PORTB.4 is declared as output pin</span>\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// Run forever</span>\n\t<span class=\"token punctuation\">{</span>\n\t\tPORTB <span class=\"token operator\">=</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Turn on</span>\n        <span class=\"token function\">T0Delay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Apply delay</span>\n        PORTB <span class=\"token operator\">=</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Turn off</span>\n        <span class=\"token function\">T0Delay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Apply delay</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<ul>\n<li>Author's method\n<ul>\n<li><img src=\"/notes/assets/images/2021-09-06-12-12-18.png\"></li>\n</ul>\n</li>\n</ul>","noteIndex":{"id":"GL4YoVrbDUHLnf946YtXV","title":"Curated Notes","vault":{"fsPath":"vault"},"type":"note","desc":"","links":[],"anchors":{},"fname":"root","updated":1630150480330,"created":1629975412335,"parent":null,"children":["Jq5ki9jf1QLTdc3DYLRW4","3ONxZ3Khb7nFPdLxlV1ib","Z2JlSyF7TPv3hFanVQhJd"],"data":{},"contentHash":"e9b530a3175371dde392f83db6e59628","custom":{"nav_order":0,"permalink":"/"},"body":"\n\r\n\r\nYou have reached the home page of my curated notes. I am a third year student pursuing Computer Science and Engineering at Ahmedabad University.\r\n\r\nFeel free to use this resource to its best potential and reach out to me on [Linkedin](https://www.linkedin.com/in/sameep-vani/) and do checkout my [GitHub](https://github.com/Sameep1234)\r\n"},"collectionChildren":null,"customHeadContent":null,"config":{"useFMTitle":true,"useNoteTitleForLink":true,"mermaid":true,"useKatex":true,"dev":{"enablePreviewV2":true},"site":{"siteUrl":"https://sameep1234.github.io","assetsPrefix":"/notes","copyAssets":true,"siteHierarchies":["root"],"siteRootDir":"docs","usePrettyRefs":true,"title":"Sameep","description":"Personal knowledge space","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"author":"Sameep","logo":"vault/logo.gif","ga_tracking":"G-VZ67P3SVZE","siteLastModified":true,"gh_edit_branch":"main","usePrettyLinks":true,"siteNotesDir":"notes","siteFaviconPath":"favicon.ico","gh_edit_link":true,"gh_edit_link_text":"Edit this page on GitHub","gh_root":"docs/","gh_edit_view_mode":"edit","writeStubs":true,"siteIndex":"root"},"version":4,"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false}},"workspace":{"dendronVersion":"0.70.0","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journalc","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableUserTags":true,"enableHashTags":true,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"}},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true}}},"__N_SSG":true}